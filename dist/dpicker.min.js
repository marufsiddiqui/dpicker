!function(e,t){"function"==typeof define&&define.amd?define("DPicker",["moment","maquette"],t):"object"==typeof module&&module.exports?module.exports=t(require("moment"),require("maquette")):e.DPicker=t(e.moment,e.maquette)}(this,function(e,t){"use strict";function n(){}function r(e){for(var t=event.target,n=t.parentNode;n!=document;){if(n.getAttribute("id")==p)return;n=n.parentNode}h=!1,f.scheduleRender()}function o(t){m=e(t.target.value,l)}function i(e){h=!0}function a(e){m.year(e.target.options[e.target.selectedIndex].value)}function u(e){m.month(e.target.options[e.target.selectedIndex].value)}function c(e){m.date(e.target.value)}function d(t){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return m=n.model||e(),this.futureYear=n.futureYear||+e().format("YYYY")+2,this.minYear=n.minYear||1986,l=this.format=n.format||"DD/MM/YYYY",h=!1,this.container=p=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^16*Math.random()>>e/4).toString(16)}),document.addEventListener("click",r),f.append(t,this.render.bind(this)),this}var s=t.h,f=t.createProjector(),p=void 0,m=void 0,l=void 0,h=void 0;return d.prototype.render=function(){return s("div.dpicker#"+p,[s("input",{value:m.format(this.format),type:"text",onchange:o,onfocus:i,name:"dpicker-input"}),s("div",{classes:{"dpicker-visible":h,"dpicker-invisible":!h}},[this.renderYears(),this.renderMonths(),this.renderDays()])])},d.prototype.renderYears=function(){for(var e=+m.format("YYYY"),t=this.futureYear,n=[];t-- >this.minYear;)n.push(s("option",{value:t,selected:t===e},""+t));return s("select",{onchange:a,name:"dpicker-year"},[n])},d.prototype.renderMonths=function(){var t=+m.format("MM");return s("select",{onchange:u,name:"dpicker-month"},e.monthsShort().map(function(e,n){return s("option",{value:n,selected:n+1===t},e)}))},d.prototype.renderDays=function(){var t=m.daysInMonth(),r=m.clone().month(-1).daysInMonth(),o=+m.clone().date(1).format("e")-1,i=m.date(),a=new Array(Math.ceil((o+t)/7)).fill(0),u=void 0,d=void 0;return s("table",[s("tr",e.weekdaysShort().map(function(e){return s("th",e)})),a.map(function(e,a){return s("tr",{key:a},new Array(7).fill(0).map(function(e,f){return o>=f&&0==a?(u=r-(o-f),d=!1):f==o+1&&0==a?(u=1,d=!0):(u==t&&(u=0,d=!1),u++),s("td",{classes:{"dpicker-active":d,"dpicker-inactive":!d}},[s(d?"button":"span",{onclick:d?c:n,value:u,classes:{"dpicker-active":i==u}},u)])}))})])},d.prototype.getModel=function(){return m},d});