!function(e,t){"function"==typeof define&&define.amd?define("DPicker",["moment","maquette"],t):"object"==typeof module&&module.exports?module.exports=t(require("moment"),require("maquette")):e.DPicker=t(e.moment,e.maquette)}(this,function(e,t){"use strict";function n(){}function r(e){return function(t,n,r){return function(){return e(t,n,r)}}}function a(n){var r=this,a=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];this._container=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^16*Math.random()>>e/4).toString(16)}),this._projector=t.createProjector();var o=a.moment||e();return this._data={model:o.clone(),format:a.format||"DD/MM/YYYY",display:a.display||!1,futureYear:a.futureYear||+o.format("YYYY")+1,pastYear:a.pastYear||1986},this._events={hide:function(e){for(var t=e.target,n=t.parentNode;n!=document;){if(n.getAttribute("id")==r._container)return;n=n.parentNode}r._data.display=!1,r._projector.scheduleRender()},inputChange:function(t){r._data.model=e(t.target.value,r._data.format)},inputFocus:function(e){r._data.display=!0},yearChange:function(e){r._data.model.year(e.target.options[e.target.selectedIndex].value)},monthChange:function(e){r._data.model.month(e.target.options[e.target.selectedIndex].value)},dayClick:function(e){r._data.model.date(e.target.value)}},document.addEventListener("click",this._events.hide),n.setAttribute("id",this._container),this._projector.append(n,this.render(this._events,this._data,[this.renderYears(this._events,this._data),this.renderMonths(this._events,this._data),this.renderDays(this._events,this._data)])),this}var o=t.h;return a.prototype.render=r(function(e,t,n){return o("div.dpicker",[o("input",{value:t.model.format(t.format),type:"text",onchange:e.inputChange,onfocus:e.inputFocus,name:"dpicker-input"}),o("div.dpicker-container",{classes:{"dpicker-visible":t.display,"dpicker-invisible":!t.display}},n.map(function(e){return e()}))])}),a.prototype.renderYears=r(function(e,t,n){for(var r=+t.model.format("YYYY"),a=t.futureYear+1,i=[];--a>=t.pastYear;)i.push(o("option",{value:a,selected:a===r},""+a));return o("select",{onchange:e.yearChange,name:"dpicker-year"},[i])}),a.prototype.renderMonths=r(function(t,n,r){var a=+n.model.format("MM");return o("select",{onchange:t.monthChange,name:"dpicker-month"},e.monthsShort().map(function(e,t){return o("option",{value:t,selected:t+1===a},e)}))}),a.prototype.renderDays=r(function(t,r,a){var i=r.model.daysInMonth(),d=r.model.clone().subtract(1,"months").daysInMonth(),c=+r.model.clone().date(1).format("e")-1,u=r.model.date(),s=new Array(Math.ceil(.1+(c+i)/7)).fill(0),p=void 0,l=void 0;return o("table",[o("tr",e.weekdaysShort().map(function(e){return o("th",e)})),s.map(function(e,r){return o("tr",{key:r},new Array(7).fill(0).map(function(e,a){return a<=c&&0==r?(p=d-(c-a),l=!1):a==c+1&&0==r?(p=1,l=!0):(p==i&&(p=0,l=!1),p++),o("td",{classes:{"dpicker-active":l,"dpicker-inactive":!l}},[o(l?"button":"span",{onclick:l?t.dayClick:n,value:p,classes:{"dpicker-active":u==p}},p)])}))})])}),Object.defineProperty(a.prototype,"container",{get:function(){return this._container}}),["model","format","display","futureYear","pastYear"].forEach(function(e){Object.defineProperty(a.prototype,e,{get:function(){return this._data[e]},set:function(t){this._data[e]=t,this._projector.scheduleRender()}})}),a});