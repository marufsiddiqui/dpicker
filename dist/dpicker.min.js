!function(e,t){"function"==typeof define&&define.amd?define("DPicker",["moment","maquette"],t):"object"==typeof module&&module.exports?module.exports=t(require("moment"),require("maquette")):e.DPicker=t(e.moment,e.maquette)}(this,function(e,t){"use strict";function n(){}function r(e){return function(t,n,r){return function(){return e(t,n,r)}}}function a(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^16*Math.random()>>e/4).toString(16)})}function o(n){var r=this,o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];this._container=a(),this._projector=t.createProjector();var i=o.moment||e();return this._data={model:i.clone(),format:o.format||"DD/MM/YYYY",display:o.display||!1,futureYear:o.futureYear||+i.format("YYYY")+1,pastYear:o.pastYear||1986,inputId:o.inputId||a()},this._events={hide:function(e){for(var t=e.target,n=t.parentNode;n!=document;){if(n.getAttribute("id")==r._container)return;n=n.parentNode}r._data.display=!1,r._projector.scheduleRender()},inputChange:function(t){r._data.model=e(t.target.value,r._data.format)},inputFocus:function(e){r._data.display=!0},yearChange:function(e){r._data.model.year(e.target.options[e.target.selectedIndex].value)},monthChange:function(e){r._data.model.month(e.target.options[e.target.selectedIndex].value)},dayClick:function(e){r._data.model.date(e.target.value)}},document.addEventListener("click",this._events.hide),n.setAttribute("id",this._container),this._projector.append(n,this.render(this._events,this._data,[this.renderYears(this._events,this._data),this.renderMonths(this._events,this._data),this.renderDays(this._events,this._data)])),this}var i=t.h;return o.prototype.render=r(function(e,t,n){return i("div.dpicker",[i("input#"+t.inputId,{value:t.model.format(t.format),type:"text",onchange:e.inputChange,onfocus:e.inputFocus,name:"dpicker-input"}),i("div.dpicker-container",{classes:{"dpicker-visible":t.display,"dpicker-invisible":!t.display}},n.map(function(e){return e()}))])}),o.prototype.renderYears=r(function(e,t,n){for(var r=+t.model.format("YYYY"),a=t.futureYear+1,o=[];--a>=t.pastYear;)o.push(i("option",{value:a,selected:a===r},""+a));return i("select",{onchange:e.yearChange,name:"dpicker-year"},[o])}),o.prototype.renderMonths=r(function(t,n,r){var a=+n.model.format("MM");return i("select",{onchange:t.monthChange,name:"dpicker-month"},e.monthsShort().map(function(e,t){return i("option",{value:t,selected:t+1===a},e)}))}),o.prototype.renderDays=r(function(t,r,a){var o=r.model.daysInMonth(),d=r.model.clone().subtract(1,"months").daysInMonth(),u=+r.model.clone().date(1).format("e")-1,c=r.model.date(),s=new Array(Math.ceil(.1+(u+o)/7)).fill(0),p=void 0,f=void 0;return i("table",[i("tr",e.weekdaysShort().map(function(e){return i("th",e)})),s.map(function(e,r){return i("tr",{key:r},new Array(7).fill(0).map(function(e,a){return u>=a&&0==r?(p=d-(u-a),f=!1):a==u+1&&0==r?(p=1,f=!0):(p==o&&(p=0,f=!1),p++),i("td",{classes:{"dpicker-active":f,"dpicker-inactive":!f}},[i(f?"button":"span",{onclick:f?t.dayClick:n,value:p,classes:{"dpicker-active":c==p}},p)])}))})])}),Object.defineProperty(o.prototype,"container",{get:function(){return this._container}}),Object.defineProperty(o.prototype,"inputId",{get:function(){return this._data.inputId}}),["model","format","display","futureYear","pastYear"].forEach(function(e){Object.defineProperty(o.prototype,e,{get:function(){return this._data[e]},set:function(t){this._data[e]=t,this._projector.scheduleRender()}})}),o});