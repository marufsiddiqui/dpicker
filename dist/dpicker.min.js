!function(e,t){"function"==typeof define&&define.amd?define("DPicker",["moment","maquette"],t):"object"==typeof module&&module.exports?module.exports=t(require("moment"),require("maquette")):e.DPicker=t(e.moment,e.maquette)}(this,function(e,t){"use strict";function n(){}function r(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];for(var n in t)n in m&&(m[n]=t[n]);return p=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^16*Math.random()>>e/4).toString(16)}),document.addEventListener("click",o),e.setAttribute("id",p),l.append(e,this.render.bind(this)),this}function o(e){for(var t=e.target,n=t.parentNode;n!=document;){if(n.getAttribute("id")==p)return;n=n.parentNode}m.display=!1,l.scheduleRender()}function i(t){m.model=e(t.target.value,m.format)}function a(e){m.display=!0}function d(e){m.model.year(e.target.options[e.target.selectedIndex].value)}function c(e){m.model.month(e.target.options[e.target.selectedIndex].value)}function u(e){m.model.date(e.target.value)}var s=t.h,l=t.createProjector(),p=void 0,f=e(),m={model:f.clone(),format:"DD/MM/YYYY",display:!1,futureYear:+f.format("YYYY")+1,pastYear:1986};r.prototype.render=function(){return s("div.dpicker",[s("input",{value:m.model.format(m.format),type:"text",onchange:i,onfocus:a,name:"dpicker-input"}),s("div.dpicker-container",{classes:{"dpicker-visible":m.display,"dpicker-invisible":!m.display}},[this.renderMonths(),this.renderYears(),this.renderDays()])])},r.prototype.renderYears=function(){for(var e=+m.model.format("YYYY"),t=this.futureYear+1,n=[];--t>=this.pastYear;)n.push(s("option",{value:t,selected:t===e},""+t));return s("select",{onchange:d,name:"dpicker-year"},[n])},r.prototype.renderMonths=function(){var t=+m.model.format("MM");return s("select",{onchange:c,name:"dpicker-month"},e.monthsShort().map(function(e,n){return s("option",{value:n,selected:n+1===t},e)}))},r.prototype.renderDays=function(){var t=m.model.daysInMonth(),r=m.model.clone().subtract(1,"months").daysInMonth(),o=+m.model.clone().date(1).format("e")-1,i=m.model.date(),a=new Array(Math.ceil(.1+(o+t)/7)).fill(0),d=void 0,c=void 0;return s("table",[s("tr",e.weekdaysShort().map(function(e){return s("th",e)})),a.map(function(e,a){return s("tr",{key:a},new Array(7).fill(0).map(function(e,l){return o>=l&&0==a?(d=r-(o-l),c=!1):l==o+1&&0==a?(d=1,c=!0):(d==t&&(d=0,c=!1),d++),s("td",{classes:{"dpicker-active":c,"dpicker-inactive":!c}},[s(c?"button":"span",{onclick:c?u:n,value:d,classes:{"dpicker-active":i==d}},d)])}))})])},Object.defineProperty(r.prototype,"container",{get:function(){return p}});var h=function(e){Object.defineProperty(r.prototype,e,{get:function(){return m[e]},set:function(t){m[e]=t,l.scheduleRender()}})};for(var v in m)h(v);return r});